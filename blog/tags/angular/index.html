<!DOCTYPE html>
<html>
  <head>


    <!-- HTML meta -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="cache-control" content="no-cache">
    <meta http-equiv="expires" content="0">
    <meta name="author" content="">
    <meta name="description" content="" />
    

    <title>Paul Dijou - Posts tagged with angular</title>

    <!-- facebook open graph tags http://ogp.me/ -->
    <meta property="og:site_name" content="Paul Dijou" />
    <meta property="og:title" content="Posts tagged with angular" />
    <meta property="og:url" content="http://pauldijou.fr/blog/tags/angular/index.html" />
    <meta property="og:description" content="" />
    
      <meta property="og:type" content="website" />
    
    
    

    <!-- twitter card tags https://dev.twitter.com/cards/markup -->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@paul_dijou" />
    
    <meta name="twitter:title" content="Paul Dijou - Posts tagged with angular" />
    <meta name="twitter:description" content="" />

    <link rel="shortcut icon" type="image/png" href="/assets/favicon-5b92c61126199f7d62a67cca38b3e33bbdd0f7a7a836dbda27ef0f09ffd3e5eb.ico"/>
    <link type="text/css" rel="stylesheet" href="/assets/css/main-e66cbeb83467c4596e317baff024f2f5aafbe0950e29acbcca992eddbcabe00c.css">
    <link href='http://fonts.googleapis.com/css?family=Lato:300,400' rel='stylesheet' type='text/css'/>

    <!--[if lt IE 8]>
      <link href="/stylesheets/ie.css" media="screen, projection" rel="stylesheet" type="text/css">
    <![endif]-->

    

    
      <script type="text/javascript">
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-25058935-1', 'auto');
        ga('send', 'pageview');
      </script>
    
  </head>
  <body>
    <header id="nav" class="nav">
  <ul class="list-unstyled">
    
      <li>
        <a href="/">
          <span class="icon fa fa-home fa-fw fa-2x"></span>
          <span class="nav-label">Home</span>
        </a>
      </li>
    
      <li>
        <a href="/blog/">
          <span class="icon fa fa-coffee fa-fw fa-2x"></span>
          <span class="nav-label">Blog</span>
        </a>
      </li>
    
      <li>
        <a href="/resume/">
          <span class="icon fa fa-code fa-fw fa-2x"></span>
          <span class="nav-label">Resume</span>
        </a>
      </li>
    
      <li>
        <a href="/projects/">
          <span class="icon fa fa-flask fa-fw fa-2x"></span>
          <span class="nav-label">Projects</span>
        </a>
      </li>
    
      <li>
        <a href="/about/">
          <span class="icon fa fa-user fa-fw fa-2x"></span>
          <span class="nav-label">About</span>
        </a>
      </li>
    
      <li>
        <a href="/contact/">
          <span class="icon fa fa-envelope fa-fw fa-2x"></span>
          <span class="nav-label">Contact</span>
        </a>
      </li>
    
      <li>
        <a href="/archives/">
          <span class="icon fa fa-archive fa-fw fa-2x"></span>
          <span class="nav-label">Archives</span>
        </a>
      </li>
    
    <li class="nav-back">
      <a href="#">
        <span class="icon fa fa-undo fa-fw fa-2x"></span>
        <span class="nav-label">Back to page</span>
      </a>
    </li>
  </ul>
</header>

<div class="nav-menu">
  <a href="#nav">Menu</a>
</div>

<div class="page container">
  <div class="posts">
  
    









<article class="post">
  <h2>
    <a href="/blog/2013/02/17/angularjs-routing-playframework/">AngularJS HTML5 routing on PlayFramework</a>
  </h2>

  <div class="meta">
    Posted by
    <span class="author"></span>
    
      on
      <span class="date">Feb 17, 2013</span>
    
    <span class="separator"></span>

    
      <span class="visible-md-inline visible-lg-inline"><span class="icon fa fa-comments fa-fw"></span></span>
      <a href="/blog/2013/02/17/angularjs-routing-playframework/#disqus_thread" data-disqus-identifier="/blog/2013/02/17/angularjs-routing-playframework">Comments</a>
      <span class="separator"></span>
    

    <span class="visible-md-inline visible-lg-inline"><span class="icon fa fa-pencil-square-o fa-fw"></span></span>
    <a class="improve visible-md-inline visible-lg-inline" href="https://github.com/pauldijou/pauldijou.github.com/edit/develop/_posts/2013-02-17-angularjs-routing-playframework.md" target="_blank">Improve this article</a>
  </div>

  <div class="content">
    <h3 id="the-problem">The problem</h3>

<p>AngularJS provides a nice <code class="highlighter-rouge">$location</code> service which allows you to deal with routing and url inside your application. It supports both a fallback mode using hashbang and a real HTML5 routing using the new <a href="http://www.whatwg.org/specs/web-apps/current-work/multipage/history.html">History API</a>. Since we love bleeding edge technologies, that’s obvious we want to use the History API if possible. Lucky us, it appears it’s quite easy to do so with a Play Framework application. Let’s see how to do that.</p>

<p>The full code of the demo is available <a href="https://github.com/blogsamples/angularjs-play21-html5-routing">on GitHub</a>.</p>

<h3 id="simple-configuration">Simple configuration</h3>

<p>Let’s keep things simple. Creating a new Play Framework application with <code class="highlighter-rouge">play new</code>. We will use a Scala application in this article, but it should as easy with a Java one. Then add AngularJS using CDN (see <a href="https://github.com/blogsamples/angularjs-play21-html5-routing/blob/master/app/views/main.scala.html#L19">main.scala.html#L19</a>). Then we will create an Angular module for our app and enable the HTML5 routing mode which is disable by default.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s2">"app"</span><span class="p">,</span> <span class="p">[</span><span class="s2">"ngResource"</span><span class="p">])</span>
  <span class="p">.</span><span class="nx">config</span><span class="p">([</span><span class="s2">"$routeProvider"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$routeProvider</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">$routeProvider</span><span class="p">.</span><span class="nx">when</span><span class="p">(</span><span class="s2">"/"</span><span class="p">,</span> <span class="p">{</span>
        <span class="na">templateUrl</span><span class="p">:</span> <span class="s2">"/views/index"</span><span class="p">,</span>
        <span class="na">controller</span><span class="p">:</span> <span class="s2">"AppCtrl"</span>
      <span class="p">}).</span><span class="nx">otherwise</span><span class="p">({</span>
        <span class="na">redirectTo</span><span class="p">:</span> <span class="s2">"/"</span>
      <span class="p">});</span>
    <span class="p">}</span>
  <span class="p">])</span>
  <span class="p">.</span><span class="nx">config</span><span class="p">([</span><span class="s2">"$locationProvider"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$locationProvider</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">$locationProvider</span><span class="p">.</span><span class="nx">html5Mode</span><span class="p">(</span><span class="kc">true</span><span class="p">).</span><span class="nx">hashPrefix</span><span class="p">(</span><span class="s2">"!"</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">]);</span></code></pre></figure>

<p>Nice. Now we will make some modification to the default views generated by Play. We want a single-page application, which means our root url must map to a main page which will contains all resource dependencies and includes the <code class="highlighter-rouge">ng-view</code> of AngularJS. I’ve done that by editing the <code class="highlighter-rouge">main.scala.html</code> file as you can <a href="https://github.com/blogsamples/angularjs-play21-html5-routing/blob/master/app/views/main.scala.html">see here</a> and add a new Play route:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># File routes</span>
GET     /                           controllers.Application.main<span class="o">(</span>any <span class="o">=</span> <span class="s2">"none"</span><span class="o">)</span></code></pre></figure>

<p>And a new <code class="highlighter-rouge">Action</code> in my Application controller:</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">def</span> <span class="n">main</span><span class="o">(</span><span class="n">any</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span> <span class="k">=</span> <span class="nc">Action</span> <span class="o">{</span>
  <span class="nc">Ok</span><span class="o">(</span><span class="n">views</span><span class="o">.</span><span class="n">html</span><span class="o">.</span><span class="n">main</span><span class="o">())</span>
<span class="o">}</span></code></pre></figure>

<p>Wait. Why is there a String param for the main method? And why do we pass a default <code class="highlighter-rouge">any = "none"</code> value? It seems a bit useless… Fair enough, I will explain it later on the article, don’t mind it for now. So, we have our main page. Let’s add some content for the landing page. As we have specified in the AngularJS routing, our root url, which is defined with <code class="highlighter-rouge">$routeProvider.when("/", ...)</code> is pointing to <code class="highlighter-rouge">/views/index</code>. So we need a Play route for that… but before, let’s talk about all those routes.</p>

<h3 id="routes-routes-routes">Routes, routes, routes…</h3>

<p>As we advance in our coding, we can see that the term “route” is used in different contexts. It’s important to fully understand them all. Play routes, which are defined in the <code class="highlighter-rouge">conf/routes</code> file, are the core of your application. It’s those routes which will answer to the HTTP requests, serving either HTML, JSON, or whatever. But you, as the developer, will be the only one to know about them. Users of your application will only use and see AngularJS routes, which are defined in your main module using the <code class="highlighter-rouge">$routeProvider</code>.</p>

<p>The idea is that when a user land on your site, it should use AngularJS routing which will then use Play routes to load the template (= the content) of the page. So why not using the exact same url for both the AngularJS route and the templateUrl route? Well, in the case of the root, it’s obvious: the Play “/” route is already required for our main page. Ok. But in a more general case, could we do:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">$routeProvider</span><span class="p">.</span><span class="nx">when</span><span class="p">(</span><span class="s2">"/page"</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">templateUrl</span><span class="p">:</span> <span class="s2">"/page"</span><span class="p">,</span>
  <span class="na">controller</span><span class="p">:</span> <span class="s2">"PageCtrl"</span>
<span class="p">})</span></code></pre></figure>

<p>Nope, you can’t. Well, that’s a small lie… you could do that, and it would work if your user <strong>always</strong> open your main page first. If he does that, then all AngularJS routing is loaded, and when the user will go to “/page” url, it will be catch by AngularJS which will ask for the “/page” on Play routes which will give him the content of the page. So what’s the problem? If you user <strong>directly</strong> land on the “/page” url, because he arrived for the first time on your application after having clicked on a link somewhere which was pointing at “/page”, then the Play route will be directly called since there is no AngularJS routing initialized at all… And that’s bad, right? The user would have the raw content of the page without any JavaScript or CSS from the main page. It’s a fail.</p>

<p>In order to prevent that, I have chosen to use some conventions. There is nothing official, you can use your own, the only thing to keep in mind is that AngularJS routes and Play routes should <strong>never</strong> be equals. My solution to do that is to prefix all Play routes serving HTML with a “/views/” prefix, all Play routes serving JSON with a “/api/” prefix and, as it is by default, all Play routes serving resources with a “/assets/” prefix. Meaning I can now use all routes I want inside AngularJS routing but never starts them with one of those prefix.</p>

<p>Of course, it will just modify the problem without solving it. Now, if a user land directly on “/page”, he will have a huge orange Play error telling him that the route doesn’t exist. As before, AngularJS routing isn’t loaded, so it’s Play routing which try to handle that and, since there is no longer any “/page” route in Play, it crash.</p>

<p>So what’s the point of having different routes? The next trick is to redirect all unknow routes to our main page. By doing so, if the user land on “/page”, Play will say <em class="talk red">“I don’t know that route, go to the main page”</em>, so the user will indeed go to your main page, but then, all AngularJS routing will be loaded and super awesome AngularJS will say <em class="talk green">“Hey, I do know that route, and I need the /views/page template”</em>, and then Play will respond <em class="talk red">“Oh yeah, I can serve you /views/page, here is the HTML to display”</em>, and your user will see the correct “/page1” content, even if he lands directly on it.</p>

<p>Another question? Why didn’t we use this trick before and then have the same routes for both AngularJS and Play? Because it’s important that the trick apply only to unknow routes. We cannot redirect to the main page an existing Play route because it needs to serve its own content. So by using different routes, we can intercept AngularJS routes inside Play as “unknown routes” and redirect them to the main page so AngularJS can handle them. I hope I’m clear enough here, that might be the hardest part of the article. In order to achieve that, we just need to put a Play route at the end of the route file which intercept all routes and redirect them to the main page:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># File routes</span>
GET     /<span class="k">*</span>any                       controllers.Application.main<span class="o">(</span>any<span class="o">)</span></code></pre></figure>

<p>And now you should understand why we had a <code class="highlighter-rouge">any: String</code> for our main page at the beginning.</p>

<h3 id="first-pages">First pages</h3>

<p>Enough with all the theory, let’s do two concrete pages: creating “page1.scala.html” and “page2.scala.html” files with basic content (see source code, I’m using a template to stay DRY about the title and the menu but that’s not important), add then as Play routes (with a “/views/” as stated before) and also add them inside our controller:</p>

<figure class="highlight"><pre><code class="language-markup" data-lang="markup">@()

@template() {
  &lt;h2&gt;Page1&lt;/h2&gt;
}</code></pre></figure>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># File routes</span>
GET     /views/page1                controllers.Application.page1</code></pre></figure>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">def</span> <span class="n">page1</span> <span class="k">=</span> <span class="nc">Action</span> <span class="o">{</span>
  <span class="nc">Ok</span><span class="o">(</span><span class="n">views</span><span class="o">.</span><span class="n">html</span><span class="o">.</span><span class="n">page1</span><span class="o">())</span>
<span class="o">}</span></code></pre></figure>

<p>And then add the AngularJS routing:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="p">.</span><span class="nx">when</span><span class="p">(</span><span class="s2">"/page1"</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">templateUrl</span><span class="p">:</span> <span class="s2">"/views/page1"</span>
<span class="p">})</span></code></pre></figure>

<p>That’s it. We can now create a link, using a <code class="highlighter-rouge">a</code> tag, to point to the url “/page1” and AngularJS will do the rest, loading the “/views/page1” template using Play route which will return the HTML code generated from our Scala template. Nice isn’t it? The url is correct: <a href="http://localhost:9000/page1">http://localhost:9000/page1</a>, you can use the back button to return to the index page, no ugly hashbang, but all in Ajax with a single-page application.</p>

<h3 id="handling-url-parameters">Handling url parameters</h3>

<p>So, we have our url working by using the History API thanks to the HTML5 mode of the AngularJS $routeProvider. But that’s only for raw url. What if we want to have dynamic parameters inside them? Just like REST, having url as “/colors/1” and “/colors/2” if we deal with colors (yeah, why not?). Do you think that’s easy? Well, you could, after all, both AngularJS and Play know how to handle parameters in their url. We could do something like:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="p">.</span><span class="nx">when</span><span class="p">(</span><span class="s2">"/colors/:id"</span><span class="p">,</span> <span class="p">{</span>
  <span class="na">templateUrl</span><span class="p">:</span> <span class="s2">"/views/color/:id"</span><span class="p">,</span>
  <span class="na">controller</span><span class="p">:</span> <span class="s2">"ColorCtrl"</span>
<span class="p">})</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c"># File routes</span>
GET     /views/color/:id             controllers.Application.color<span class="o">(</span>id: String<span class="o">)</span></code></pre></figure>

<p>Nope, we can’t. Why? Because the “templateUrl” cannot handle url parameters. It’s just a template. And of course, using <code class="highlighter-rouge">templateUrl: "/views/color"</code> will not pass any “id” parameter to the Play route. Damn…</p>

<p>That’s not a problem in fact. Just keep to the AngularJS way of doing things: it’s not Play who should handle the data any longuer, it’s AngularJS who rules the world now, so you don’t need any params in your Scala code, just trust AngularJS. Ok, but we need a way to load the correct color depending on the id in the url right? Sure thing. It’s the role of AngularJS controller to that. That’s why there is a “ColorCtrl” along with our template, and guess what, the AngularJS controller know about the url params. Here is the code of the controller:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">app</span><span class="p">.</span><span class="nx">controller</span><span class="p">(</span><span class="s2">"ColorCtrl"</span><span class="p">,</span> <span class="p">[</span>
  <span class="s2">"$scope"</span><span class="p">,</span>
  <span class="s2">"$routeParams"</span><span class="p">,</span>
  <span class="kd">function</span><span class="p">(</span><span class="nx">$scope</span><span class="p">,</span> <span class="nx">$routeParams</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Thanks to scope inheritance,</span>
    <span class="c1">// we can access the "db" from the AppCtrl scope</span>
    <span class="nx">$scope</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="nx">$scope</span><span class="p">.</span><span class="nx">db</span><span class="p">[</span><span class="nx">$routeParams</span><span class="p">.</span><span class="nx">id</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">$scope</span><span class="p">.</span><span class="nx">color</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">$scope</span><span class="p">.</span><span class="nx">msg</span> <span class="o">=</span> <span class="s2">"There is no color for id "</span><span class="o">+</span><span class="nx">$routeParams</span><span class="p">.</span><span class="nx">id</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">$scope</span><span class="p">.</span><span class="nx">msg</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">])</span></code></pre></figure>

<p>And just for fun, I’ve defined the fake database in the “AppCtrl”:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">app</span><span class="p">.</span><span class="nx">controller</span><span class="p">(</span><span class="s2">"AppCtrl"</span><span class="p">,</span> <span class="p">[</span><span class="s2">"$scope"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$scope</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">$scope</span><span class="p">.</span><span class="nx">db</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mi">1</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">name</span><span class="p">:</span> <span class="s2">"black"</span><span class="p">,</span>
      <span class="na">hex</span><span class="p">:</span> <span class="s2">"000000"</span>
    <span class="p">},</span>
    <span class="mi">2</span><span class="p">:</span> <span class="p">{</span>
      <span class="na">name</span><span class="p">:</span> <span class="s2">"white"</span><span class="p">,</span>
      <span class="na">hex</span><span class="p">:</span> <span class="s2">"FFFFFF"</span>
    <span class="p">}</span>
  <span class="p">};</span>
<span class="p">}]);</span></code></pre></figure>

<p>So as we can see, using the <code class="highlighter-rouge">$routeParams</code> service, we can retrieve the url params and then load the correct color in the <code class="highlighter-rouge">$scope</code>. At the end, it’s just a matter of displaying that color in our view using AngularJS data-binding:</p>

<figure class="highlight"><pre><code class="language-markup" data-lang="markup">@()

@template() {
  &lt;div data-ng-show="msg"&gt;
    &lt;h2&gt;&lt;/h2&gt;
  &lt;/div&gt;

  &lt;div data-ng-hide="msg"&gt;
    &lt;h2&gt;Color : # &lt;/h2&gt;
  &lt;/div&gt;
}</code></pre></figure>

<p>And that’s it! you can now display some data depending of params inside your url (and show an error message in case the data doesn’t exist). Cool isn’t it?</p>

<h3 id="want-more">Want more?</h3>

<p>Oh God, you are still reading? You should already be able to do anything you need. But if you want, we can dive in a more complex example, using AngularJS <code class="highlighter-rouge">$resource</code> service and serve JSON from Play like a REST API would do. Sounds good for you? Ok, let’s do that. First, we will create a “Users” controller and it will have two methods: “all()” and “find(id: String)” which will return an Array of Json and a Json object representing our list of users and one particular user based on its id. I will not use a real database, but something like MongoDB would fit really good in there. Here is the code:</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">package</span> <span class="nn">controllers</span>

<span class="k">import</span> <span class="nn">play.api._</span>
<span class="k">import</span> <span class="nn">play.api.mvc._</span>
<span class="k">import</span> <span class="nn">play.api.libs.json._</span>

<span class="k">object</span> <span class="nc">Users</span> <span class="k">extends</span> <span class="nc">Controller</span> <span class="o">{</span>
  <span class="k">val</span> <span class="n">db</span> <span class="k">=</span> <span class="nc">Json</span><span class="o">.</span><span class="n">arr</span><span class="o">(</span>
    <span class="nc">Json</span><span class="o">.</span><span class="n">obj</span><span class="o">(</span> <span class="s">"id"</span> <span class="o">-&gt;</span> <span class="s">"1"</span><span class="o">,</span> <span class="s">"name"</span> <span class="o">-&gt;</span> <span class="s">"John"</span> <span class="o">),</span>
    <span class="nc">Json</span><span class="o">.</span><span class="n">obj</span><span class="o">(</span> <span class="s">"id"</span> <span class="o">-&gt;</span> <span class="s">"2"</span><span class="o">,</span> <span class="s">"name"</span> <span class="o">-&gt;</span> <span class="s">"Suzanne"</span> <span class="o">)</span>
  <span class="o">)</span>

  <span class="k">def</span> <span class="n">all</span><span class="o">()</span> <span class="k">=</span> <span class="nc">Action</span> <span class="o">{</span>
    <span class="nc">Ok</span><span class="o">(</span><span class="n">db</span><span class="o">)</span>
  <span class="o">}</span>

  <span class="k">def</span> <span class="n">find</span><span class="o">(</span><span class="n">id</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span> <span class="k">=</span> <span class="nc">Action</span> <span class="o">{</span>
    <span class="nc">Ok</span><span class="o">(</span><span class="n">db</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">filter</span><span class="o">(</span><span class="n">v</span> <span class="k">=&gt;</span> <span class="o">(</span><span class="n">v</span> <span class="o">\</span> <span class="s">"id"</span><span class="o">).</span><span class="n">as</span><span class="o">[</span><span class="kt">JsString</span><span class="o">].</span><span class="n">value</span> <span class="o">==</span> <span class="n">id</span><span class="o">).</span><span class="n">headOption</span><span class="o">.</span><span class="n">getOrElse</span><span class="o">(</span><span class="k">new</span> <span class="nc">JsUndefined</span><span class="o">(</span><span class="s">""</span><span class="o">)))</span>
  <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<p>If you don’t fully understand it, you can check the PlayFramework documentation about handling Json (<a href="http://www.playframework.com/documentation/2.1.0/ScalaJsonRequests">ScalaJsonRequests</a>). I am using the new Json API from Play 2.1 (<a href="http://www.playframework.com/documentation/api/2.1.0/scala/index.html#play.api.libs.json.package">play.api.libs.json.package</a>). Next we need our “UserCtrl” which will use the `$resource&lt;/code&gt; service to retrieve the data:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">app</span><span class="p">.</span><span class="nx">controller</span><span class="p">(</span><span class="s2">"UserCtrl"</span><span class="p">,</span> <span class="p">[</span>
  <span class="s2">"$scope"</span><span class="p">,</span>
  <span class="s2">"$routeParams"</span><span class="p">,</span>
  <span class="s2">"$resource"</span><span class="p">,</span>
  <span class="s2">"apiUrl"</span><span class="p">,</span>
  <span class="kd">function</span><span class="p">(</span><span class="nx">$scope</span><span class="p">,</span> <span class="nx">$routeParams</span><span class="p">,</span> <span class="nx">$resource</span><span class="p">,</span> <span class="nx">apiUrl</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">Users</span> <span class="o">=</span> <span class="nx">$resource</span><span class="p">(</span><span class="nx">apiUrl</span> <span class="o">+</span> <span class="s2">"/users/:id"</span><span class="p">,</span> <span class="p">{</span><span class="na">id</span><span class="p">:</span><span class="s2">"@id"</span><span class="p">});</span>

    <span class="k">if</span><span class="p">(</span><span class="nx">$routeParams</span><span class="p">.</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">$scope</span><span class="p">.</span><span class="nx">user</span> <span class="o">=</span> <span class="nx">Users</span><span class="p">.</span><span class="kd">get</span><span class="p">({</span><span class="na">id</span><span class="p">:</span> <span class="nx">$routeParams</span><span class="p">.</span><span class="nx">id</span><span class="p">},</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">$scope</span><span class="p">.</span><span class="nx">user</span><span class="p">.</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">$scope</span><span class="p">.</span><span class="nx">msg</span> <span class="o">=</span> <span class="s2">"There is no user for id "</span><span class="o">+</span><span class="nx">$routeParams</span><span class="p">.</span><span class="nx">id</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="nx">$scope</span><span class="p">.</span><span class="nx">msg</span> <span class="o">=</span> <span class="kc">undefined</span><span class="p">;</span>
        <span class="p">}</span>
      <span class="p">});</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">$scope</span><span class="p">.</span><span class="nx">users</span> <span class="o">=</span> <span class="nx">Users</span><span class="p">.</span><span class="nx">query</span><span class="p">();</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">])</span></code></pre></figure>

<p>To learn more about AngularJS $resource definition, see: <a href="http://docs.angularjs.org/api/ngResource.$resource">ngResource.$resource</a>. What is that “apiUrl” by the way? It’s a constant I’ve defined in my AngularJS app:</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s2">"app"</span><span class="p">,</span> <span class="p">[</span><span class="s2">"ngResource"</span><span class="p">])</span>
  <span class="p">.</span><span class="nx">constant</span><span class="p">(</span><span class="s2">"apiUrl"</span><span class="p">,</span> <span class="s2">"http://localhost:9000\:9000/api"</span><span class="p">)</span></code></pre></figure>

<p class="alert alert-info"><strong>Pro tip</strong> Why is there the 9000 port twice? That’s because if we had written <code class="highlighter-rouge">http://localhost:9000/api</code>, AngularJS syntax would have analyzed that as a url with a dynamic parameter named “9000” because it’s placed right after a <code class="highlighter-rouge">:</code> character. So we need that strange syntax to tell AngularJS that this is not a parameter but a real value in our url.</p>

<p>Next, we are creating our resource by extending this apiUrl with our routing “/users/:id”. This time, “:id” is a real parameter. We can now use “get” and “query” methods on the resource, passing or not a value to the id, in order to retrieve our Json code and assign it to the <code class="highlighter-rouge">$scope</code>. We will need two Scala views: one for the list and one for the detail of course.</p>

<figure class="highlight"><pre><code class="language-markup" data-lang="markup">@()

@template() {
  &lt;h2&gt;Users&lt;/h2&gt;

  &lt;ul&gt;
    &lt;li data-ng-repeat="u in users"&gt;
      &lt;a data-ng-href="/users/"&gt;User# : &lt;/a&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
}</code></pre></figure>

<figure class="highlight"><pre><code class="language-markup" data-lang="markup">@()

@template() {
  &lt;div data-ng-show="msg"&gt;
    &lt;h2&gt;&lt;/h2&gt;
  &lt;/div&gt;

  &lt;div data-ng-hide="msg"&gt;
    &lt;h2&gt;User#  &lt;/h2&gt;
  &lt;/div&gt;
}</code></pre></figure>

<p>And that’s it. We now have a list of users and links to each user detail, and all that data is fetch from a REST API using Json.</p>

<p class="alert alert-info"><strong>Pro tip</strong> By the way, since our Play routes doesn’t clash with AngularJS routes, you can load them directly in your browser. It will works because the Play route handling the redirection to the main page is at the end of the route file, so any real Play route will be loaded before the redirection. If you have the demo running, check <a href="http://localhost:9000/api/users">http://localhost:9000/api/users</a> and <a href="http://localhost:9000/api/users/1">http://localhost:9000/api/users/1</a> to see your REST API working nicely.</p>

<h3 id="conclusion">Conclusion</h3>

<p>I hope this article will help you bootstrap your next awesome application using awesome tools like AngularJS and PlayFramework. Your next step (if that’s not already the case) would be to learn more about the new PlayFramework Json API so you can have typesafe Json (if I can say so). You would also probably need to plug a database on it. One choice could be a <a href="http://www.mongodb.org/">MongDB</a> database since it can store raw Json, and interact with it using a nice driver like <a href="http://reactivemongo.org/">ReactiveMongo</a> if you want to go all the way down to asynchronous application.</p>

<p>It’s up to you!</p>

  </div>

  <div class="footer">
    <span class="hidden-xs hidden-sm">
      <span class="icon fa fa-link fa-fw"></span>
      <a href="http://pauldijou.fr/blog/2013/02/17/angularjs-routing-playframework/">Permalink</a>
    </span>
    <span class="separator"></span>

    <span class="visible-md-inline visible-lg-inline"><span class="icon fa fa-pencil-square-o fa-fw"></span></span>
    <a href="https://github.com/pauldijou/pauldijou.github.com/edit/develop/_posts/2013-02-17-angularjs-routing-playframework.md" target="_blank" class="improve visible-md-inline visible-lg-inline">Improve this article</a>
    <a href="https://github.com/pauldijou/pauldijou.github.com/edit/develop/_posts/2013-02-17-angularjs-routing-playframework.md" target="_blank" class="improve button block hidden-md hidden-lg">
      <span class="icon fa fa-pencil-square fa-fw"></span>
      Improve this article
    </a>

    
      <div class="tags">
        <span class="icon fa fa-tags fa-fw"></span>
        Tags:
        
          <a class="tag label label-default" href="/blog/tags/angular/">angular</a>
        
          <a class="tag label label-default" href="/blog/tags/play/">play</a>
        
          <a class="tag label label-default" href="/blog/tags/html5/">html5</a>
        
      </div>
    

  </div>

  
</article>

  
    









<article class="post">
  <h2>
    <a href="/blog/2012/11/27/some-pocs-to-share/">Some POCs to share</a>
  </h2>

  <div class="meta">
    Posted by
    <span class="author"></span>
    
      on
      <span class="date">Nov 27, 2012</span>
    
    <span class="separator"></span>

    
      <span class="visible-md-inline visible-lg-inline"><span class="icon fa fa-comments fa-fw"></span></span>
      <a href="/blog/2012/11/27/some-pocs-to-share/#disqus_thread" data-disqus-identifier="/blog/2012/11/27/some-pocs-to-share">Comments</a>
      <span class="separator"></span>
    

    <span class="visible-md-inline visible-lg-inline"><span class="icon fa fa-pencil-square-o fa-fw"></span></span>
    <a class="improve visible-md-inline visible-lg-inline" href="https://github.com/pauldijou/pauldijou.github.com/edit/develop/_posts/2012-11-27-some-pocs-to-share.md" target="_blank">Improve this article</a>
  </div>

  <div class="content">
    <h3 id="some-pocs">Some POCs</h3>

<p>Hi there,</p>

<p>I’ve been a bit busy lately but I’m back on game. Looking for a job in Paris, I’ve been asked to do some code over more or less funny subjects and now that it’s done, I will share them, maybe it could help people to see some code around some technologies. It’s not at all perfect code, more experiments I’ve done.</p>

<p><strong>Mowing</strong> is mainly a <code class="highlighter-rouge">CoffeeScript</code> project about giving orders to some automatic mowers and see the result. My goal was to test that new syntax around JavaScript and I have to admit it’s quite cool. You can see <a href="http://pauldijou.fr/mowing/">the result here</a> (don’t ever do it in large grids). The source code is <a href="https://github.com/pauldijou/mowing/">here on GitHub</a></p>

<p><strong>Mowing-java</strong> is the <code class="highlighter-rouge">Java</code> version of <strong>Mowing</strong>. So in fact, it’s nearly the same syntax since you can create class in CoffeeScript but this one runs on a JVM. <a href="https://github.com/pauldijou/mowing-java">See here</a> for source code.</p>

<p>Finally, <strong>GSearch</strong> is an <code class="highlighter-rouge">AngularJS</code> application built using <code class="highlighter-rouge">Yeoman</code>. Its goal is to plug on GitHub API and allow you to search through repositories and users and display informations and stats about them. <a href="http://pauldijou.fr/gsearch/">Here is the result</a> and <a href="https://github.com/pauldijou/gsearch/">go there</a> for source code.</p>

<p>Of course, <strong>any feedback</strong> is welcome! I can be bugs, features, questions, anything…</p>

<h3 id="nigthhacking-tour-2012">NigthHacking Tour 2012</h3>

<p>I’ve given a small quicky about <code class="highlighter-rouge">RichFaces Bootstrap</code> and <code class="highlighter-rouge">RichFaces 5</code> on Paris a few weeks ago. Just so you know…</p>

<h3 id="are-you-in-paris">Are you in Paris?</h3>

<p>Let’s finish with a personal note. I will be living in Paris from now and for quite some time. So if you living there or just passing by and want to grab a beer and talk about Java EE, HTML5, RichFaces, or anything cool, just let me now! Also if you are giving conferences or doing dojos or katas in the area, be sure to notice me so I can come to the next one. Thanks.</p>

  </div>

  <div class="footer">
    <span class="hidden-xs hidden-sm">
      <span class="icon fa fa-link fa-fw"></span>
      <a href="http://pauldijou.fr/blog/2012/11/27/some-pocs-to-share/">Permalink</a>
    </span>
    <span class="separator"></span>

    <span class="visible-md-inline visible-lg-inline"><span class="icon fa fa-pencil-square-o fa-fw"></span></span>
    <a href="https://github.com/pauldijou/pauldijou.github.com/edit/develop/_posts/2012-11-27-some-pocs-to-share.md" target="_blank" class="improve visible-md-inline visible-lg-inline">Improve this article</a>
    <a href="https://github.com/pauldijou/pauldijou.github.com/edit/develop/_posts/2012-11-27-some-pocs-to-share.md" target="_blank" class="improve button block hidden-md hidden-lg">
      <span class="icon fa fa-pencil-square fa-fw"></span>
      Improve this article
    </a>

    
      <div class="tags">
        <span class="icon fa fa-tags fa-fw"></span>
        Tags:
        
          <a class="tag label label-default" href="/blog/tags/angular/">angular</a>
        
          <a class="tag label label-default" href="/blog/tags/coffeescript/">coffeescript</a>
        
          <a class="tag label label-default" href="/blog/tags/yeoman/">yeoman</a>
        
      </div>
    

  </div>

  
</article>

  
</div>

<ul class="list-inline pagination text-center visible-xs visible-sm">
  <li>
    
      <span class="button disabled">
        <span class="icon fa fa-angle-left fa-lg"></span>
        Previous
      </span>
    
  </li>

  <li>
    
      <span class="button disabled">
        Next
        <span class="icon fa fa-angle-right fa-lg"></span>
      </span>
    
  </li>
</ul>

<ul class="list-inline pagination text-center hidden-xs hidden-sm">
    
      <li>
        <span class="button disabled">
          <span class="icon fa fa-angle-double-left fa-lg"></span>
          First
        </span>
      </li>
      <li>
        <span class="button disabled">
          <span class="icon fa fa-angle-left fa-lg"></span>
          Previous
        </span>
      </li>
    

    <li>
      <span class="button">1 of 1</span>
    </li>

    
      <li>
        <span class="button disabled">
          Next
          <span class="icon fa fa-angle-right fa-lg"></span>
        </span>
      </li>
      <li>
        <span class="button disabled">
          Last
          <span class="icon fa fa-angle-double-right fa-lg"></span>
        </span>
      </li>
    
</ul>

<div style="margin-bottom:20px;text-align:center;">
  <a class="button" href="http://feeds2.feedburner.com/pauldijou">
  <span class="icon fa fa-rss fa-lg"></span>
  Subscribe
</a>

</div>

<script id="dsq-count-scr" src="https://pauldijou.disqus.com/count.js" async></script>


</div>


    <script type="text/javascript" src="/assets/js/main-a35bb44a42985a5ff06fe724109076616abccf20668ed9c7419518a3b125015d.js"></script>

    <!--[if lt IE 9]>
      <script src="//html5shim.googlecode.com/svn/trunk/html5.js" type="text/javascript"></script>
    <![endif]-->

    
  </body>
</html>
